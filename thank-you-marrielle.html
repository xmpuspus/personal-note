<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>thank-you-marrielle</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #fef5f1 0%, #fef0ed 50%, #fde8e9 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #2c2c2c;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }

        /* Lock Screen Styles */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #fef5f1 0%, #fef0ed 50%, #fde8e9 100%);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 1;
            transition: opacity 0.5s ease;
            padding: 20px;
        }

        .lock-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(60px) saturate(180%);
            -webkit-backdrop-filter: blur(60px) saturate(180%);
            z-index: -1;
        }

        .lock-screen.unlocked {
            opacity: 0;
            pointer-events: none;
        }

        .lock-time {
            font-size: 5rem;
            font-weight: 200;
            color: #3d3d3d;
            margin-bottom: 4px;
            letter-spacing: -2px;
        }

        .lock-date {
            font-size: 1.125rem;
            font-weight: 500;
            color: #6b6b6b;
            margin-bottom: 80px;
        }

        .lock-message {
            font-size: 1rem;
            font-weight: 400;
            color: rgba(61, 61, 61, 0.6);
            margin-bottom: 20px;
        }

        .retry-warning {
            font-size: 0.875rem;
            color: #ff3b30;
            text-align: center;
            margin-bottom: 20px;
            height: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .retry-warning.show {
            opacity: 1;
        }

        .retry-warning.critical {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .passcode-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        .passcode-dots {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .passcode-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 2px solid rgba(61, 61, 61, 0.3);
            background: transparent;
            transition: all 0.2s ease;
        }

        .passcode-dot.filled {
            background: #3d3d3d;
            border-color: #3d3d3d;
        }

        .passcode-dot.shake {
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .numpad {
            display: grid;
            grid-template-columns: repeat(3, 80px);
            gap: 20px;
            margin-top: 20px;
        }

        .numpad-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            border: none;
            color: #3d3d3d;
            font-size: 2rem;
            font-weight: 300;
            cursor: pointer;
            transition: all 0.15s ease;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', system-ui, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0;
            padding-top: 4px;
        }

        .numpad-letters {
            font-size: 0.5rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            opacity: 0.5;
            margin-top: -4px;
        }

        .numpad-button:hover {
            background: rgba(255, 255, 255, 0.7);
            transform: scale(1.05);
        }

        .numpad-button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.8);
        }

        .numpad-button.delete {
            background: rgba(255, 255, 255, 0.3);
            font-size: 1.5rem;
            font-weight: 400;
            padding-top: 0;
        }

        .error-message {
            color: #ff3b30;
            font-size: 0.9rem;
            height: 20px;
            margin-top: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .error-message.show {
            opacity: 1;
        }

        .container {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, #e8a5a5 0%, #d4899a 100%);
            border-radius: 50%;
            opacity: 0;
            animation: float linear infinite;
            pointer-events: none;
            will-change: transform, opacity;
        }

        @keyframes float {
            0% {
                opacity: 0;
                transform: translateY(-50px) translateX(0) scale(0.5);
            }
            20% {
                opacity: 0.5;
            }
            80% {
                opacity: 0.25;
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) translateX(80px) scale(1);
            }
        }

        .screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transform: scale(0.95);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 40px;
        }

        .screen.active {
            opacity: 1;
            transform: scale(1);
            z-index: 10;
        }

        .start-screen h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4.5em;
            font-weight: 600;
            color: #3d3d3d;
            text-align: center;
            margin-bottom: 24px;
            letter-spacing: -0.5px;
            line-height: 1.15;
        }

        .start-screen .subtitle {
            font-family: 'Crimson Text', serif;
            font-size: 1.5rem;
            color: #6b6b6b;
            text-align: center;
            margin-bottom: 56px;
            max-width: 560px;
            font-weight: 400;
            line-height: 1.75;
        }

        button {
            background: linear-gradient(135deg, #d4899a 0%, #c77588 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            font-size: 1.125rem;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Crimson Text', serif;
            box-shadow: 0 2px 12px rgba(212, 137, 154, 0.2);
            letter-spacing: 0.3px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(212, 137, 154, 0.3);
            background: linear-gradient(135deg, #d89ba7 0%, #d08194 100%);
        }

        button:active {
            transform: translateY(0);
        }

        .photo-screen {
            text-align: center;
        }

        .photo-container {
            position: relative;
            width: 600px;
            height: 450px;
            margin-bottom: 40px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .photo-container:hover {
            transform: scale(1.02);
        }

        .photo-frame {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }

        .photo-frame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(212, 137, 154, 0.1) 0%, rgba(199, 117, 136, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .photo-container:hover .photo-frame::before {
            opacity: 1;
        }

        .photo-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 8px;
        }

        .photo-caption {
            font-size: 1.25rem;
            color: #4a4a4a;
            margin-top: 20px;
            font-weight: 400;
            line-height: 1.6;
            max-width: 600px;
        }

        .nav-buttons {
            margin-top: 32px;
            display: flex;
            gap: 12px;
            margin-bottom: 80px;
        }

        .letter-screen {
            max-width: 900px;
            width: 100%;
            text-align: left;
            padding: 0 20px;
        }

        .letter-container {
            background: white;
            padding: 50px 45px;
            border-radius: 20px;
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.1);
            max-height: 82vh;
            overflow-y: auto;
            border: 1px solid rgba(212, 137, 154, 0.1);
            position: relative;
        }

        .letter-container::after {
            content: '';
            position: sticky;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: linear-gradient(to bottom, transparent, white);
            pointer-events: none;
            display: block;
            margin: 0 -45px -50px -45px;
            border-radius: 0 0 20px 20px;
        }

        .letter-container::-webkit-scrollbar {
            width: 6px;
        }

        .letter-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .letter-container::-webkit-scrollbar-thumb {
            background: rgba(212, 137, 154, 0.3);
            border-radius: 10px;
        }

        .letter-container::-webkit-scrollbar-thumb:hover {
            background: rgba(212, 137, 154, 0.5);
        }

        .letter-container {
            scroll-behavior: smooth;
        }

        /* Smooth scroll padding for mobile */
        @supports (-webkit-touch-callout: none) {
            .letter-container {
                -webkit-overflow-scrolling: touch;
            }
        }

        .letter-container h2 {
            font-family: 'Playfair Display', serif;
            color: #3d3d3d;
            font-size: 2.75rem;
            font-weight: 600;
            margin-bottom: 45px;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .letter-text {
            font-family: 'Crimson Text', serif;
            font-size: 1.3125rem;
            line-height: 2;
            color: #4a4a4a;
            white-space: pre-wrap;
            font-weight: 400;
            text-align: justify;
            text-justify: inter-word;
            transition: opacity 0.5s ease, filter 0.5s ease;
        }

        .letter-text::first-line {
            line-height: 2.2;
        }

        .letter-signature {
            margin-top: 60px;
            text-align: right;
            font-family: 'Crimson Text', serif;
            color: #6b6b6b;
            font-size: 1.4375rem;
            font-weight: 400;
            font-style: italic;
            padding-bottom: 20px;
        }

        .progress-bar {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            border-radius: 100px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
        }

        .progress-segment {
            width: 36px;
            height: 3px;
            background: #e5e5e5;
            border-radius: 2px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-segment::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #d4899a 0%, #c77588 100%);
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .progress-segment.active::before {
            width: 100%;
        }

        .progress-segment.completed {
            background: linear-gradient(90deg, #d4899a 0%, #c77588 100%);
        }

        .keyboard-hint {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.875rem;
            color: #999;
            opacity: 0;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }

        @media (max-width: 768px) {
            .photo-container {
                width: 90vw;
                height: 70vw;
                max-width: 500px;
            }

            .start-screen h1 {
                font-size: 2.75rem;
                line-height: 1.2;
            }

            .start-screen .subtitle {
                font-size: 1.1875rem;
                line-height: 1.65;
                padding: 0 10px;
            }

            .letter-screen {
                padding: 0 16px;
            }

            .letter-container {
                padding: 36px 24px 32px 24px;
                max-height: 85vh;
                border-radius: 16px;
            }

            .letter-container::after {
                height: 50px;
                margin: 0 -24px -32px -24px;
                border-radius: 0 0 16px 16px;
            }

            .letter-container h2 {
                font-size: 2.125rem;
                margin-bottom: 36px;
            }

            .letter-text {
                font-size: 1.1875rem;
                line-height: 1.95;
                text-align: left;
            }

            .letter-signature {
                font-size: 1.3125rem;
                margin-top: 50px;
                padding-bottom: 15px;
            }

            .lock-time {
                font-size: 4.5rem;
            }

            .lock-date {
                margin-bottom: 70px;
                font-size: 1.0625rem;
            }

            .lock-message {
                font-size: 1.0625rem;
                margin-bottom: 16px;
            }

            .numpad {
                grid-template-columns: repeat(3, 78px);
                gap: 15px;
            }

            .numpad-button {
                width: 78px;
                height: 78px;
                font-size: 1.875rem;
                font-weight: 300;
            }

            .numpad-button.delete {
                font-size: 1.375rem;
            }

            .progress-bar {
                bottom: 24px;
                padding: 10px 18px;
            }

            .progress-segment {
                width: 32px;
            }

            button {
                padding: 16px 36px;
                font-size: 1.1875rem;
            }
        }

        @media (max-width: 430px) {
            .letter-container {
                padding: 32px 20px 28px 20px;
            }

            .letter-container::after {
                margin: 0 -20px -28px -20px;
            }

            .letter-text {
                font-size: 1.125rem;
                line-height: 1.9;
            }

            .letter-container h2 {
                font-size: 2rem;
            }
        }

        @media (max-width: 390px) {
            .lock-time {
                font-size: 4rem;
            }

            .lock-date {
                margin-bottom: 60px;
            }

            .numpad {
                grid-template-columns: repeat(3, 72px);
                gap: 13px;
            }

            .numpad-button {
                width: 72px;
                height: 72px;
                font-size: 1.75rem;
                font-weight: 300;
            }

            .numpad-button.delete {
                font-size: 1.25rem;
            }

            .letter-container {
                padding: 28px 18px 24px 18px;
                max-height: 86vh;
            }

            .letter-container::after {
                margin: 0 -18px -24px -18px;
            }

            .letter-text {
                font-size: 1.0625rem;
                line-height: 1.85;
            }

            .letter-signature {
                font-size: 1.25rem;
                margin-top: 45px;
            }

            .start-screen h1 {
                font-size: 2.25rem;
            }

            .start-screen .subtitle {
                font-size: 1.0625rem;
            }

            button {
                padding: 14px 32px;
                font-size: 1.125rem;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Lock Screen -->
    <div class="lock-screen" id="lockScreen">
        <div class="lock-time" id="lockTime">12:00</div>
        <div class="lock-date" id="lockDate">Sunday, October 19</div>
        <div class="lock-message">Enter Passcode</div>
        
        <div class="retry-warning" id="retryWarning">
            <div id="retryText"></div>
        </div>
        
        <div class="passcode-container">
            <div class="passcode-dots" id="passcodeDots">
                <div class="passcode-dot"></div>
                <div class="passcode-dot"></div>
                <div class="passcode-dot"></div>
                <div class="passcode-dot"></div>
                <div class="passcode-dot"></div>
                <div class="passcode-dot"></div>
            </div>
            
            <div class="error-message" id="errorMessage">Incorrect Passcode</div>
            
            <div class="numpad">
                <button class="numpad-button" onclick="enterDigit('1')">1<span class="numpad-letters"></span></button>
                <button class="numpad-button" onclick="enterDigit('2')">2<span class="numpad-letters">ABC</span></button>
                <button class="numpad-button" onclick="enterDigit('3')">3<span class="numpad-letters">DEF</span></button>
                <button class="numpad-button" onclick="enterDigit('4')">4<span class="numpad-letters">GHI</span></button>
                <button class="numpad-button" onclick="enterDigit('5')">5<span class="numpad-letters">JKL</span></button>
                <button class="numpad-button" onclick="enterDigit('6')">6<span class="numpad-letters">MNO</span></button>
                <button class="numpad-button" onclick="enterDigit('7')">7<span class="numpad-letters">PQRS</span></button>
                <button class="numpad-button" onclick="enterDigit('8')">8<span class="numpad-letters">TUV</span></button>
                <button class="numpad-button" onclick="enterDigit('9')">9<span class="numpad-letters">WXYZ</span></button>
                <button class="numpad-button" style="opacity: 0; pointer-events: none;"></button>
                <button class="numpad-button" onclick="enterDigit('0')">0</button>
                <button class="numpad-button delete" onclick="deleteDigit()">⌫</button>
            </div>
        </div>
    </div>

    <div class="container" id="container">
        <!-- Floating particles will be added dynamically -->
        
        <!-- Start Screen -->
        <div class="screen active start-screen" id="screen-0">
            <h1>For You, Marrielle</h1>
            <p class="subtitle">A note I didn't know how to say out loud.</p>
            <button onclick="nextScreen()">Open</button>
        </div>

        <!-- Letter Screen -->
        <div class="screen letter-screen" id="screen-1">
            <div class="letter-container">
                <h2>To Marrielle</h2>
                <div class="letter-text" id="letterText">Hiiii,

Before I go, I just wanted to say thank you. Working with you has been one of the brightest parts of my time here, and I'll always be grateful for everything we shared along the way — the car rides, the late nights, the food trips, the laughter, the kulit moments, and all the random conversations that made long days easier to carry. You made the grind lighter, and the journey a lot more memorable.

Thank you for your patience, your honesty, and the way you always showed up — especially on the days when things were heavy, chaotic, or just plain exhausting. I learned a lot from you, not only about the work, but about resilience, humor, and staying human in the middle of the madness.

I'll miss our rhythm — the jokes, the side-eye reactions in meetings, the "you okay?" check-ins, and the way we could just pick up a conversation with zero context and it somehow still made sense. It's rare to find someone you can work with and laugh with that naturally.

As I move forward, I'm genuinely rooting for you — for everything you want to build, and everything you want to become. I hope life gives you good people, good challenges, and good days ahead. And I hope you keep that spark — the one that makes people feel lighter just by being around you.

Thank you for being an important part of my story here. I'm glad our paths crossed. I really am.</div>
                <div class="letter-signature" id="letterSignature">-Your engineering partner</div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar" id="progressBar"></div>
        
        <!-- Keyboard Hint -->
        <div class="keyboard-hint" id="keyboardHint">Press → or Space to continue</div>
    </div>

    <script>
        // Passcode System
        const CORRECT_PASSCODES = ['131375', '103962'];
        const MAX_ATTEMPTS = 10;
        let enteredPasscode = '';
        let failedAttempts = parseInt(localStorage.getItem('failedAttempts') || '0');

        function updateTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('lockTime').textContent = `${hours}:${minutes}`;
            
            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            document.getElementById('lockDate').textContent = now.toLocaleDateString('en-US', options);
        }

        function enterDigit(digit) {
            if (enteredPasscode.length < 6) {
                enteredPasscode += digit;
                updatePasscodeDots();
                
                if (enteredPasscode.length === 6) {
                    checkPasscode();
                }
            }
        }

        function deleteDigit() {
            if (enteredPasscode.length > 0) {
                enteredPasscode = enteredPasscode.slice(0, -1);
                updatePasscodeDots();
            }
        }

        function updatePasscodeDots() {
            const dots = document.querySelectorAll('.passcode-dot');
            dots.forEach((dot, index) => {
                if (index < enteredPasscode.length) {
                    dot.classList.add('filled');
                } else {
                    dot.classList.remove('filled');
                }
                dot.classList.remove('shake');
            });
            
            document.getElementById('errorMessage').classList.remove('show');
            
            // Hide retry warning when user starts typing
            if (enteredPasscode.length > 0) {
                document.getElementById('retryWarning').classList.remove('show');
            }
        }

        function checkPasscode() {
            if (CORRECT_PASSCODES.includes(enteredPasscode)) {
                // Correct passcode - reset attempts
                localStorage.setItem('failedAttempts', '0');
                failedAttempts = 0;
                
                setTimeout(() => {
                    document.getElementById('lockScreen').classList.add('unlocked');
                    sessionStorage.setItem('unlocked', 'true');
                }, 300);
            } else {
                // Wrong passcode
                failedAttempts++;
                localStorage.setItem('failedAttempts', failedAttempts.toString());
                
                const attemptsLeft = MAX_ATTEMPTS - failedAttempts;
                
                // Check if max attempts reached
                if (failedAttempts >= MAX_ATTEMPTS) {
                    // Delete the letter (simulate by showing error and preventing access)
                    document.body.innerHTML = `
                        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #000; color: #fff; font-family: 'Inter', sans-serif; text-align: center; padding: 40px;">
                            <div>
                                <h1 style="font-size: 2rem; margin-bottom: 20px;">Access Denied</h1>
                                <p style="font-size: 1.125rem; opacity: 0.7;">The letter has been permanently deleted due to too many failed attempts.</p>
                            </div>
                        </div>
                    `;
                    return;
                }
                
                const dots = document.querySelectorAll('.passcode-dot');
                dots.forEach(dot => dot.classList.add('shake'));
                document.getElementById('errorMessage').classList.add('show');
                
                // Show retry warning
                const retryWarning = document.getElementById('retryWarning');
                const retryText = document.getElementById('retryText');
                
                if (attemptsLeft <= 3) {
                    retryWarning.classList.add('critical');
                    retryText.innerHTML = `⚠️ ${attemptsLeft} attempt${attemptsLeft === 1 ? '' : 's'} remaining<br><span style="font-size: 0.8rem;">The letter will be permanently deleted</span>`;
                } else {
                    retryWarning.classList.remove('critical');
                    retryText.textContent = `${attemptsLeft} attempts remaining before deletion`;
                }
                
                retryWarning.classList.add('show');
                
                setTimeout(() => {
                    enteredPasscode = '';
                    updatePasscodeDots();
                }, 800);
            }
        }

        // Check if already unlocked in this session
        function checkLockStatus() {
            // Always show password screen in new browsers (sessionStorage is browser-specific)
            const unlocked = sessionStorage.getItem('unlocked');
            if (unlocked === 'true') {
                document.getElementById('lockScreen').classList.add('unlocked');
            }
            
            // Check if max attempts reached
            if (failedAttempts >= MAX_ATTEMPTS) {
                document.body.innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #000; color: #fff; font-family: 'Inter', sans-serif; text-align: center; padding: 40px;">
                        <div>
                            <h1 style="font-size: 2rem; margin-bottom: 20px;">Access Denied</h1>
                            <p style="font-size: 1.125rem; opacity: 0.7;">The letter has been permanently deleted due to too many failed attempts.</p>
                        </div>
                    </div>
                `;
            } else if (failedAttempts > 0) {
                // Show remaining attempts if there were previous failures
                const attemptsLeft = MAX_ATTEMPTS - failedAttempts;
                const retryWarning = document.getElementById('retryWarning');
                const retryText = document.getElementById('retryText');
                
                if (attemptsLeft <= 3) {
                    retryWarning.classList.add('critical');
                    retryText.innerHTML = `⚠️ ${attemptsLeft} attempt${attemptsLeft === 1 ? '' : 's'} remaining<br><span style="font-size: 0.8rem;">The letter will be permanently deleted</span>`;
                } else {
                    retryText.textContent = `${attemptsLeft} attempts remaining before deletion`;
                }
                
                retryWarning.classList.add('show');
            }
        }

        // Reset letter to default on every page load
        function resetLetterToDefault() {
            const letterText = document.getElementById('letterText');
            if (letterText) {
                letterText.textContent = defaultLetter;
                isHiddenLetterShown = false;
            }
        }

        // Lock on page unload
        window.addEventListener('beforeunload', () => {
            sessionStorage.removeItem('unlocked');
        });

        // Hidden letter feature
        let tapCount = 0;
        let tapTimer = null;
        let isHiddenLetterShown = false;

        const defaultLetter = `Hiiii,

Before I go, I just wanted to say thank you. Working with you has been one of the brightest parts of my time here, and I'll always be grateful for everything we shared along the way — the car rides, the late nights, the food trips, the laughter, the kulit moments, and all the random conversations that made long days easier to carry. You made the grind lighter, and the journey a lot more memorable.

Thank you for your patience, your honesty, and the way you always showed up — especially on the days when things were heavy, chaotic, or just plain exhausting. I learned a lot from you, not only about the work, but about resilience, humor, and staying human in the middle of the madness.

I'll miss our rhythm — the jokes, the side-eye reactions in meetings, the "you okay?" check-ins, and the way we could just pick up a conversation with zero context and it somehow still made sense. It's rare to find someone you can work with and laugh with that naturally.

As I move forward, I'm genuinely rooting for you — for everything you want to build, and everything you want to become. I hope life gives you good people, good challenges, and good days ahead. And I hope you keep that spark — the one that makes people feel lighter just by being around you.

Thank you for being an important part of my story here. I'm glad our paths crossed. I really am.`;

        const hiddenLetter = `Hiiii,

Sooo, there's no easy way to put this into words, but I need to try—if only so I can leave with a sense of peace.

When I think back on everything we've shared, it's impossible not to smile a little before the ache sets in. The car rides to and from work, the late-night dinners and drinks at your favorite spots, you bringing me to places I'd never been before. The times we played hooky just to breathe for a bit. The deep conversations that went from work to life and back again. The quiet, unplanned hours that somehow became the best memories. The way the most random days became good days, just because you were in them.

You've been my partner in countless long nights, my grounding presence when everything else got too loud. You stayed late at the office with me, showed up even when you didn't have to, and carried both patience and fire in equal measure. You challenged me when I needed pushing, called me out when I needed grounding, and reminded me to laugh when I was burning myself out. You somehow balanced being both chaos and calm, and I didn't realize how much I leaned on that until now.

Thank you for the laughter, the honesty, the little moments of care you didn't even realize you were giving. For every fight we had and every time we found a way to be okay after. For understanding me, even when I didn't deserve it. For seeing me at my faults, and not turning away. For the optimism I borrowed from you on days I had none of my own. For the comfort, the banter, the stubborn debates, and the rare silences that said more than either of us dared to.

Leaving now feels heavier than I expected—not because of the work, but because you were such a big part of what made it meaningful. I'll miss the rhythm we fell into without ever naming it. The morning messages. The random makulit check-ins, even when I would pull back and isolate. The side comments in meetings. The stupid jokes. The familiar presence. I'll miss the version of the day that only existed when you were in it.

I'll carry every version of us that existed between the lines: the tired, the driven, the laughing, the quiet. The days we kept each other going. The nights we refused to quit. The moments that came and went without a picture, without a witness, without a label—just something real that lived briefly in time.

If I'm honest, a small part of me wishes we had met at a different time, in a different season, with different circumstances. Still, I'm grateful it happened at all. What we were—whatever we were—will always matter to me. So I'll walk forward, carrying the light of it, hoping that in your own journey, you'll find days that feel easy, people who choose you, and moments that make you feel as understood as you once made me feel.

I know life moves forward, and we both have paths we're meant to honor. But I'd be lying if I said this goodbye didn't carry a weight with it. There's a sadness in knowing that some bonds can't be fully expressed, some truths can't be spoken, and some goodbyes happen quietly between the lines.

Goodbye, Marrielle. I'll miss you more quietly than you'll ever know—but I'll still be rooting for you, from a distance, in a life that keeps moving.

Thank you for what we never put into words, and for the moments I'll hold onto long after this.`;

        function initializeSignatureTap() {
            const signature = document.getElementById('letterSignature');
            let hasGlowed = false;
            
            signature.addEventListener('click', function() {
                tapCount++;
                
                // Vibrate on mobile if supported
                if (navigator.vibrate) {
                    navigator.vibrate(10);
                }
                
                // Show glow hint on first tap
                if (!hasGlowed && tapCount === 1) {
                    this.style.textShadow = '0 0 20px rgba(212, 137, 154, 0.6)';
                    hasGlowed = true;
                    setTimeout(() => {
                        this.style.textShadow = 'none';
                    }, 800);
                }
                
                // Clear existing timer
                if (tapTimer) {
                    clearTimeout(tapTimer);
                }
                
                // Visual feedback - subtle pulse
                this.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                }, 100);
                
                // Check if triple tap
                if (tapCount === 3) {
                    // Stronger vibration for success
                    if (navigator.vibrate) {
                        navigator.vibrate([50, 30, 50]);
                    }
                    toggleLetter();
                    tapCount = 0;
                }
                
                // Reset tap count after 800ms
                tapTimer = setTimeout(() => {
                    tapCount = 0;
                }, 800);
            });
            
            // Add cursor pointer and transition
            signature.style.cursor = 'pointer';
            signature.style.transition = 'transform 0.1s ease, opacity 0.5s ease, text-shadow 0.5s ease, filter 0.5s ease';
        }

        function toggleLetter() {
            const letterText = document.getElementById('letterText');
            const letterContainer = document.querySelector('.letter-container');
            
            // Blur and fade out
            letterText.style.filter = 'blur(10px)';
            letterText.style.opacity = '0';
            
            setTimeout(() => {
                // Swap content
                if (isHiddenLetterShown) {
                    letterText.textContent = defaultLetter;
                    isHiddenLetterShown = false;
                } else {
                    letterText.textContent = hiddenLetter;
                    isHiddenLetterShown = true;
                }
                
                // Scroll to top
                letterContainer.scrollTop = 0;
                
                // Remove blur and fade in
                setTimeout(() => {
                    letterText.style.filter = 'blur(0px)';
                    letterText.style.opacity = '1';
                }, 50);
            }, 500);
        }

        // Main app logic
        let currentScreen = 0;
        const totalScreens = 2;
        let isTransitioning = false;

        // Initialize progress bar
        function initProgressBar() {
            const progressBar = document.getElementById('progressBar');
            for (let i = 0; i < totalScreens; i++) {
                const segment = document.createElement('div');
                segment.className = 'progress-segment' + (i === 0 ? ' active' : '');
                segment.id = `segment-${i}`;
                progressBar.appendChild(segment);
            }
        }

        // Create floating particles
        function createParticles() {
            const container = document.getElementById('container');
            const lockScreen = document.getElementById('lockScreen');
            const particleColors = ['#e8a5a5', '#d4899a', '#f5cdd3', '#e0b3ba'];
            
            // Fewer particles on mobile for better performance
            const particleCount = window.innerWidth <= 768 ? 10 : 15;
            
            // Add particles to main container
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.background = `radial-gradient(circle, ${particleColors[Math.floor(Math.random() * particleColors.length)]} 0%, transparent 100%)`;
                particle.style.animationDuration = (Math.random() * 8 + 12) + 's';
                particle.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(particle);
            }

            // Add particles to lock screen
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.background = `radial-gradient(circle, ${particleColors[Math.floor(Math.random() * particleColors.length)]} 0%, transparent 100%)`;
                particle.style.animationDuration = (Math.random() * 8 + 12) + 's';
                particle.style.animationDelay = Math.random() * 5 + 's';
                lockScreen.appendChild(particle);
            }
        }

        function nextScreen() {
            if (isTransitioning || currentScreen >= totalScreens - 1) return;
            
            isTransitioning = true;
            
            const current = document.getElementById(`screen-${currentScreen}`);
            const currentSegment = document.getElementById(`segment-${currentScreen}`);
            
            current.classList.remove('active');
            currentSegment.classList.remove('active');
            currentSegment.classList.add('completed');
            
            currentScreen++;
            
            setTimeout(() => {
                const next = document.getElementById(`screen-${currentScreen}`);
                const nextSegment = document.getElementById(`segment-${currentScreen}`);
                next.classList.add('active');
                nextSegment.classList.add('active');
                
                setTimeout(() => {
                    isTransitioning = false;
                }, 800);
            }, 100);
        }

        function previousScreen() {
            if (isTransitioning || currentScreen <= 0) return;
            
            isTransitioning = true;
            
            const current = document.getElementById(`screen-${currentScreen}`);
            const currentSegment = document.getElementById(`segment-${currentScreen}`);
            
            current.classList.remove('active');
            currentSegment.classList.remove('active');
            
            currentScreen--;
            
            const prev = document.getElementById(`screen-${currentScreen}`);
            const prevSegment = document.getElementById(`segment-${currentScreen}`);
            prevSegment.classList.remove('completed');
            
            setTimeout(() => {
                prev.classList.add('active');
                prevSegment.classList.add('active');
                
                setTimeout(() => {
                    isTransitioning = false;
                }, 800);
            }, 100);
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Only allow navigation if unlocked
            if (sessionStorage.getItem('unlocked') !== 'true') return;
            
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                nextScreen();
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                previousScreen();
            }
        });

        // Swipe support for mobile
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (sessionStorage.getItem('unlocked') !== 'true') return;
            
            if (touchStartX - touchEndX > 50) {
                nextScreen();
            }
            if (touchEndX - touchStartX > 50) {
                previousScreen();
            }
        }

        // Show keyboard hint on first screen
        function showKeyboardHint() {
            const hint = document.getElementById('keyboardHint');
            setTimeout(() => {
                hint.style.animation = 'fadeInOut 3s ease-in-out';
            }, 2000);
        }

        // Initialize everything
        window.addEventListener('load', () => {
            updateTime();
            setInterval(updateTime, 1000);
            checkLockStatus();
            resetLetterToDefault();
            initProgressBar();
            createParticles();
            showKeyboardHint();
            initializeSignatureTap();
        });
    </script>
</body>
</html>